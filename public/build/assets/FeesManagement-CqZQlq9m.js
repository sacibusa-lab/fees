import{r as c,u as w,j as e,H as F,a as T}from"./app-13HG_1GY.js";import{L as M}from"./Layout-DRo6Tvgr.js";import{F as B,a as L}from"./FeeClassOverridesModal-BROLjXY1.js";import{P as O}from"./plus-C93rPDiC.js";import"./createLucideIcon-DZqVtFvv.js";import"./circle-alert-CnL9XqZw.js";import"./trash-2-C5-eo-9B.js";import"./save-ZK0MI-_h.js";const I=({fees:o=[],feeCount:u=0,bankAccounts:p=[],classes:h=[]})=>{const[x,r]=c.useState(!1),[n,j]=c.useState("add"),[i,v]=c.useState(null),[g,b]=c.useState(!1),[_,y]=c.useState(!1),{data:a,setData:l,post:N,put:f,processing:m,reset:d,errors:t,clearErrors:C}=w({title:"",revenue_code:"",cycle:"termly",type:"compulsory",payee_allowed:"students",amount:"",first_term_amount:"",second_term_amount:"",third_term_amount:"",first_term_active:!0,second_term_active:!0,third_term_active:!0,charge_bearer:"self",status:"active"}),S=()=>{j("add"),v(null),d(),C(),r(!0)},k=s=>{s.preventDefault(),n==="add"?N("/fees",{onSuccess:()=>{r(!1),d()}}):f(`/fees/${i.id}`,{onSuccess:()=>{r(!1),d()}})};return e.jsxs(M,{children:[e.jsx(F,{title:`Fees - ${u}`}),e.jsxs("div",{className:"fees-page-container",children:[e.jsxs("div",{className:"fees-top-bar",children:[e.jsxs("h1",{className:"page-heading",children:["Fees - ",e.jsx("span",{className:"count",children:u})]}),e.jsxs("button",{className:"add-fee-btn-outline",onClick:S,children:[e.jsx(O,{size:18}),"Add Fee"]})]}),e.jsx("div",{className:"fees-table-wrapper card",children:e.jsx("div",{className:"table-scroll-area",children:e.jsxs("table",{className:"fees-data-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"S/N"}),e.jsx("th",{children:"Title"}),e.jsx("th",{children:"Revenue Code"}),e.jsx("th",{children:"Cycle"}),e.jsx("th",{children:"Type"}),e.jsx("th",{children:"Payers Allowed"}),e.jsx("th",{children:"Amount"}),e.jsx("th",{children:"Charge Bearer"}),e.jsx("th",{className:"status-col",children:"Status"})]})}),e.jsxs("tbody",{children:[o.map((s,A)=>e.jsxs("tr",{onClick:()=>T.visit(`/fees/${s.id}`),style:{cursor:"pointer"},children:[e.jsx("td",{children:A+1}),e.jsxs("td",{className:"title-cell-accent",children:[s.title,s.beneficiaries&&s.beneficiaries.length>0&&e.jsxs("span",{className:"split-badge",children:["Split (",s.beneficiaries.length,")"]})]}),e.jsx("td",{children:s.revenueCode}),e.jsx("td",{children:s.cycle}),e.jsx("td",{children:s.type}),e.jsx("td",{children:s.payeeAllowed}),e.jsx("td",{children:s.amount}),e.jsx("td",{children:s.chargeBear}),e.jsx("td",{children:e.jsxs("span",{className:`status-pill ${s.status.toLowerCase()}`,children:[e.jsx("span",{className:"pill-dot"}),s.status]})}),e.jsx("td",{className:"actions-cell"})]},s.id)),o.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:"10",className:"no-records",children:"No fees found."})})]})]})})}),x&&e.jsx("div",{className:"modal-overlay",onClick:()=>r(!1),children:e.jsxs("div",{className:`modal-content ${n==="set-amount"?"":"wide-modal"}`,onClick:s=>s.stopPropagation(),children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h3",{children:n==="add"?"Add New Fee":n==="edit"?"Edit Fee":"Set Fee Amount"}),e.jsx("button",{className:"close-btn",onClick:()=>r(!1),children:"×"})]}),e.jsxs("form",{onSubmit:k,className:"modern-fee-form",children:[n==="set-amount"?e.jsxs("div",{className:"input-group",children:[e.jsx("label",{children:"Amount (₦) *"}),e.jsx("input",{type:"number",value:a.amount,onChange:s=>l("amount",s.target.value),placeholder:"0",required:!0,autoFocus:!0}),t.amount&&e.jsx("span",{className:"error-msg",children:t.amount}),e.jsx("p",{style:{fontSize:"0.8rem",color:"#666",marginTop:"5px"},children:"This will update the fee amount for all students."})]}):e.jsxs("div",{className:"form-layout-grid",children:[e.jsxs("div",{className:"input-group",children:[e.jsx("label",{children:"Fee Title *"}),e.jsx("input",{type:"text",value:a.title,onChange:s=>l("title",s.target.value),placeholder:"e.g., 2nd Term School Fees",required:!0}),t.title&&e.jsx("span",{className:"error-msg",children:t.title})]}),e.jsxs("div",{className:"input-group",children:[e.jsx("label",{children:"Revenue Code *"}),e.jsx("input",{type:"text",value:a.revenue_code,onChange:s=>l("revenue_code",s.target.value),placeholder:"e.g., FNG7244210",required:!0}),t.revenue_code&&e.jsx("span",{className:"error-msg",children:t.revenue_code})]}),e.jsxs("div",{className:"input-group",children:[e.jsx("label",{children:"Cycle *"}),e.jsxs("select",{value:a.cycle,onChange:s=>l("cycle",s.target.value),children:[e.jsx("option",{value:"termly",children:"Termly"}),e.jsx("option",{value:"annually",children:"Annually"}),e.jsx("option",{value:"one-time",children:"One-time"})]})]}),e.jsxs("div",{className:"input-group",children:[e.jsx("label",{children:"Type *"}),e.jsxs("select",{value:a.type,onChange:s=>l("type",s.target.value),children:[e.jsx("option",{value:"compulsory",children:"Compulsory"}),e.jsx("option",{value:"optional",children:"Optional"})]})]}),e.jsxs("div",{className:"input-group",children:[e.jsx("label",{children:"Payee Allowed *"}),e.jsxs("select",{value:a.payee_allowed,onChange:s=>l("payee_allowed",s.target.value),children:[e.jsx("option",{value:"students",children:"Students"}),e.jsx("option",{value:"all",children:"All"})]})]}),e.jsxs("div",{className:"input-group",children:[e.jsx("label",{children:"Target Class (Optional)"}),e.jsxs("select",{value:a.class_id||"",onChange:s=>l("class_id",s.target.value),children:[e.jsx("option",{value:"",children:"All Classes"}),h.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))]}),e.jsx("small",{style:{color:"#666",fontSize:"0.85em"},children:"Leave empty to apply to all classes"})]}),e.jsxs("div",{className:"input-group",children:[e.jsx("label",{children:"Default Amount (₦) *"}),e.jsx("input",{type:"number",value:a.amount,onChange:s=>l("amount",s.target.value),placeholder:"0",required:!0}),t.amount&&e.jsx("span",{className:"error-msg",children:t.amount}),e.jsx("small",{style:{color:"#666",fontSize:"0.85em"},children:"Used when term-specific amounts are not set"})]}),e.jsxs("div",{className:"input-group",children:[e.jsx("label",{children:"1st Term Amount (₦)"}),e.jsx("input",{type:"number",value:a.first_term_amount,onChange:s=>l("first_term_amount",s.target.value),placeholder:"Leave blank to use default"}),t.first_term_amount&&e.jsx("span",{className:"error-msg",children:t.first_term_amount})]}),e.jsxs("div",{className:"input-group",children:[e.jsx("label",{children:"2nd Term Amount (₦)"}),e.jsx("input",{type:"number",value:a.second_term_amount,onChange:s=>l("second_term_amount",s.target.value),placeholder:"Leave blank to use default"}),t.second_term_amount&&e.jsx("span",{className:"error-msg",children:t.second_term_amount})]}),e.jsxs("div",{className:"input-group",children:[e.jsx("label",{children:"3rd Term Amount (₦)"}),e.jsx("input",{type:"number",value:a.third_term_amount,onChange:s=>l("third_term_amount",s.target.value),placeholder:"Leave blank to use default"}),t.third_term_amount&&e.jsx("span",{className:"error-msg",children:t.third_term_amount})]}),e.jsxs("div",{className:"input-group",style:{gridColumn:"span 2",marginTop:"10px"},children:[e.jsx("label",{style:{marginBottom:"10px",display:"block",fontWeight:"600"},children:"Term Activation"}),e.jsxs("div",{className:"term-checkbox-group",children:[e.jsxs("label",{className:"term-checkbox-label",children:[e.jsx("input",{type:"checkbox",checked:a.first_term_active,onChange:s=>l("first_term_active",s.target.checked)}),e.jsx("span",{children:"1st Term"})]}),e.jsxs("label",{className:"term-checkbox-label",children:[e.jsx("input",{type:"checkbox",checked:a.second_term_active,onChange:s=>l("second_term_active",s.target.checked)}),e.jsx("span",{children:"2nd Term"})]}),e.jsxs("label",{className:"term-checkbox-label",children:[e.jsx("input",{type:"checkbox",checked:a.third_term_active,onChange:s=>l("third_term_active",s.target.checked)}),e.jsx("span",{children:"3rd Term"})]})]}),e.jsx("small",{children:"Select which terms this fee should be included in payment schedules"})]}),e.jsxs("div",{className:"input-group",children:[e.jsx("label",{children:"Charge Bearer *"}),e.jsxs("select",{value:a.charge_bearer,onChange:s=>l("charge_bearer",s.target.value),children:[e.jsx("option",{value:"self",children:"Self"}),e.jsx("option",{value:"institution",children:"Institution"})]})]}),e.jsxs("div",{className:"input-group",children:[e.jsx("label",{children:"Status *"}),e.jsxs("select",{value:a.status,onChange:s=>l("status",s.target.value),children:[e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"inactive",children:"Inactive"})]})]})]}),e.jsxs("div",{className:"modal-footer-actions",children:[e.jsx("button",{type:"button",className:"secondary-btn",onClick:()=>r(!1),children:"Cancel"}),e.jsx("button",{type:"submit",className:"primary-btn",disabled:m,children:m?"Processing...":n==="add"?"Add Fee":"Save Changes"})]})]})]})}),g&&i&&e.jsx(B,{fee:i,onClose:()=>b(!1),bankAccounts:p}),_&&i&&e.jsx(L,{fee:i,classes:h,onClose:()=>y(!1)})]})]})};export{I as default};

import{u as y,j as e}from"./app-Cw431tS5.js";import{C as j}from"./circle-alert-Dm9_0hGG.js";import{T as v}from"./trash-2-3uUCkDpT.js";import{P as w}from"./plus-DIwhttK9.js";import{S as _}from"./save-BXm_2YSZ.js";const z=({fee:i,onClose:s})=>{const u=i.beneficiaries&&i.beneficiaries.length>0?i.beneficiaries.map(t=>({...t,amount:Math.round(parseFloat(t.percentage)/100*i.raw_amount)})):[{account_name:"",account_number:"",bank_name:"",amount:""}],{data:n,setData:c,post:x,processing:m,errors:k}=y({beneficiaries:u}),g=()=>{c("beneficiaries",[...n.beneficiaries,{account_name:"",account_number:"",bank_name:"",amount:""}])},b=t=>{const r=[...n.beneficiaries];r.splice(t,1),c("beneficiaries",r)},d=(t,r,a)=>{const l=[...n.beneficiaries];if(r==="amount"){const f=parseFloat(a)||0;l[t].amount=a,l[t].percentage=i.raw_amount>0?(f/i.raw_amount*100).toFixed(2):0}else l[t][r]=a;c("beneficiaries",l)},p=n.beneficiaries.reduce((t,r)=>t+(parseFloat(r.amount)||0),0),o=Math.abs(p-i.raw_amount)<1,h=t=>{if(t.preventDefault(),!o){alert(`Total amount must equal ₦${i.raw_amount.toLocaleString()}`);return}x(`/fees/${i.id}/beneficiaries`,{onSuccess:()=>{s()}})};return e.jsx("div",{className:"modal-overlay",onClick:s,style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},children:e.jsxs("div",{className:"modal-content",onClick:t=>t.stopPropagation(),style:{background:"white",borderRadius:"12px",width:"90%",maxWidth:"800px",maxHeight:"90vh",overflowY:"auto",boxShadow:"0 10px 25px rgba(0,0,0,0.1)"},children:[e.jsxs("div",{className:"modal-header",style:{padding:"20px 24px",borderBottom:"1px solid #eee",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("div",{children:[e.jsx("h3",{style:{margin:0,fontSize:"1.25rem",color:"#1a1a1a"},children:"Split Beneficiaries"}),e.jsxs("p",{style:{margin:"4px 0 0",color:"#666",fontSize:"0.9rem"},children:["Total Fee Amount: ",e.jsxs("strong",{children:["₦",i.raw_amount.toLocaleString()]})]})]}),e.jsx("button",{onClick:s,style:{background:"none",border:"none",fontSize:"24px",cursor:"pointer",color:"#999"},children:"×"})]}),e.jsxs("form",{onSubmit:h,style:{padding:"24px"},children:[!o&&e.jsxs("div",{style:{display:"flex",gap:"10px",padding:"12px",background:"#ffebee",borderRadius:"8px",color:"#c62828",marginBottom:"20px",fontSize:"0.9rem"},children:[e.jsx(j,{size:20}),e.jsxs("div",{children:[e.jsx("strong",{children:"Invalid Total Allocation"}),e.jsxs("p",{style:{margin:0},children:["Total split must equal ₦",i.raw_amount.toLocaleString(),". Current: ₦",p.toLocaleString()," (Diff: ₦",(i.raw_amount-p).toLocaleString(),")"]})]})]}),e.jsxs("div",{className:"beneficiaries-list",children:[e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr 120px 40px",gap:"12px",paddingBottom:"8px",borderBottom:"1px solid #eee",marginBottom:"12px",fontWeight:"600",fontSize:"0.85rem",color:"#666"},children:[e.jsx("div",{children:"Account Name"}),e.jsx("div",{children:"Account Number"}),e.jsx("div",{children:"Bank Name"}),e.jsx("div",{children:"Amount (₦)"}),e.jsx("div",{})]}),n.beneficiaries.map((t,r)=>e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr 120px 40px",gap:"12px",marginBottom:"12px",alignItems:"start"},children:[e.jsx("input",{type:"text",value:t.account_name,onChange:a=>d(r,"account_name",a.target.value),placeholder:"Account Name",required:!0,style:{width:"100%",padding:"10px",borderRadius:"6px",border:"1px solid #ddd"}}),e.jsx("input",{type:"text",value:t.account_number,onChange:a=>d(r,"account_number",a.target.value),placeholder:"0000000000",required:!0,style:{width:"100%",padding:"10px",borderRadius:"6px",border:"1px solid #ddd"}}),e.jsx("input",{type:"text",value:t.bank_name,onChange:a=>d(r,"bank_name",a.target.value),placeholder:"Bank Name",required:!0,style:{width:"100%",padding:"10px",borderRadius:"6px",border:"1px solid #ddd"}}),e.jsxs("div",{style:{position:"relative"},children:[e.jsx("input",{type:"number",value:t.amount,onChange:a=>d(r,"amount",a.target.value),placeholder:"0",required:!0,min:"0",max:i.raw_amount,style:{width:"100%",padding:"10px",borderRadius:"6px",border:"1px solid #ddd"}}),e.jsx("span",{style:{position:"absolute",right:"0",top:"42px",color:"#999",fontSize:"0.75rem",width:"100%",textAlign:"right"},children:t.percentage?`${parseFloat(t.percentage).toFixed(1)}%`:"0%"})]}),e.jsx("button",{type:"button",onClick:()=>b(r),style:{height:"40px",color:"#d32f2f",background:"#ffebee",border:"none",borderRadius:"6px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(v,{size:18})})]},r))]}),e.jsxs("button",{type:"button",className:"add-row-btn",onClick:g,style:{marginTop:"20px",color:"#E91E63",fontWeight:"500",background:"transparent",border:"1px dashed #E91E63",padding:"10px",width:"100%",borderRadius:"6px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px"},children:[e.jsx(w,{size:18})," Add Another Account"]}),e.jsxs("div",{style:{marginTop:"24px",paddingTop:"20px",borderTop:"1px solid #eee",display:"flex",justifyContent:"flex-end",gap:"12px"},children:[e.jsx("button",{type:"button",onClick:s,style:{padding:"10px 20px",borderRadius:"6px",border:"1px solid #ddd",background:"white",color:"#666",cursor:"pointer",fontWeight:"500"},children:"Cancel"}),e.jsxs("button",{type:"submit",disabled:m||!o,style:{padding:"10px 24px",borderRadius:"6px",border:"none",background:o?"#E91E63":"#ccc",color:"white",cursor:o?"pointer":"not-allowed",fontWeight:"500",display:"flex",alignItems:"center",gap:"8px"},children:[e.jsx(_,{size:18})," Save Splits"]})]})]})]})})};export{z as F};

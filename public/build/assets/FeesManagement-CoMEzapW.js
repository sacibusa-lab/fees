import{r as i,u as F,j as e,H as _,e as M}from"./app-BCarpXMs.js";import{L as E}from"./Layout-B3rwuiMz.js";import{F as T}from"./FeeBeneficiariesModal-Bmab_xjO.js";import{P as k}from"./plus-BWWLHb2z.js";import"./createLucideIcon-CIR4QTd_.js";import"./circle-alert-Cg6Xkyog.js";import"./trash-2-BLrQkM20.js";import"./save-2ciUQ_wz.js";const H=({fees:u=[],feeCount:h=0,bankAccounts:x=[]})=>{const[j,n]=i.useState(!1),[r,v]=i.useState("add"),[d,g]=i.useState(null),[y,N]=i.useState(!1),[m,b]=i.useState(null),{data:l,setData:a,post:f,put:C,processing:p,reset:o,errors:t,clearErrors:S}=F({title:"",revenue_code:"",cycle:"termly",type:"compulsory",payee_allowed:"students",amount:"",charge_bearer:"self",status:"active"}),w=()=>{v("add"),g(null),o(),S(),n(!0)},A=s=>{s.preventDefault(),r==="add"?f("/fees",{onSuccess:()=>{n(!1),o()}}):C(`/fees/${d.id}`,{onSuccess:()=>{n(!1),o()}})};return i.useEffect(()=>{const s=c=>{m&&!c.target.closest(".actions-cell")&&!c.target.closest(".action-menu-portal")&&b(null)};return document.addEventListener("mousedown",s),()=>document.removeEventListener("mousedown",s)},[m]),e.jsxs(E,{children:[e.jsx(_,{title:`Fees - ${h}`}),e.jsxs("div",{className:"fees-page-container",children:[e.jsxs("div",{className:"fees-top-bar",children:[e.jsxs("h1",{className:"page-heading",children:["Fees - ",e.jsx("span",{className:"count",children:h})]}),e.jsxs("button",{className:"add-fee-btn-outline",onClick:w,children:[e.jsx(k,{size:18}),"Add Fee"]})]}),e.jsx("div",{className:"fees-table-wrapper card",children:e.jsx("div",{className:"table-scroll-area",children:e.jsxs("table",{className:"fees-data-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"S/N"}),e.jsx("th",{children:"Title"}),e.jsx("th",{children:"Revenue Code"}),e.jsx("th",{children:"Cycle"}),e.jsx("th",{children:"Type"}),e.jsx("th",{children:"Payers Allowed"}),e.jsx("th",{children:"Amount"}),e.jsx("th",{children:"Charge Bearer"}),e.jsx("th",{className:"status-col",children:"Status"}),e.jsx("th",{className:"actions-col"})]})}),e.jsxs("tbody",{children:[u.map((s,c)=>e.jsxs("tr",{onClick:()=>M.visit(`/fees/${s.id}`),style:{cursor:"pointer"},children:[e.jsx("td",{children:c+1}),e.jsxs("td",{className:"title-cell-accent",children:[s.title,s.beneficiaries&&s.beneficiaries.length>0&&e.jsxs("span",{className:"split-badge",children:["Split (",s.beneficiaries.length,")"]})]}),e.jsx("td",{children:s.revenueCode}),e.jsx("td",{children:s.cycle}),e.jsx("td",{children:s.type}),e.jsx("td",{children:s.payeeAllowed}),e.jsx("td",{children:s.amount}),e.jsx("td",{children:s.chargeBear}),e.jsx("td",{children:e.jsxs("span",{className:`status-pill ${s.status.toLowerCase()}`,children:[e.jsx("span",{className:"pill-dot"}),s.status]})}),e.jsx("td",{className:"actions-cell"})]},s.id)),u.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:"10",className:"no-records",children:"No fees found."})})]})]})})}),j&&e.jsx("div",{className:"modal-overlay",onClick:()=>n(!1),children:e.jsxs("div",{className:`modal-content ${r==="set-amount"?"":"wide-modal"}`,onClick:s=>s.stopPropagation(),children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h3",{children:r==="add"?"Add New Fee":r==="edit"?"Edit Fee":"Set Fee Amount"}),e.jsx("button",{className:"close-btn",onClick:()=>n(!1),children:"×"})]}),e.jsxs("form",{onSubmit:A,className:"modern-fee-form",children:[r==="set-amount"?e.jsxs("div",{className:"input-group",children:[e.jsx("label",{children:"Amount (₦) *"}),e.jsx("input",{type:"number",value:l.amount,onChange:s=>a("amount",s.target.value),placeholder:"0",required:!0,autoFocus:!0}),t.amount&&e.jsx("span",{className:"error-msg",children:t.amount}),e.jsx("p",{style:{fontSize:"0.8rem",color:"#666",marginTop:"5px"},children:"This will update the fee amount for all students."})]}):e.jsxs("div",{className:"form-layout-grid",children:[e.jsxs("div",{className:"input-group",children:[e.jsx("label",{children:"Fee Title *"}),e.jsx("input",{type:"text",value:l.title,onChange:s=>a("title",s.target.value),placeholder:"e.g., 2nd Term School Fees",required:!0}),t.title&&e.jsx("span",{className:"error-msg",children:t.title})]}),e.jsxs("div",{className:"input-group",children:[e.jsx("label",{children:"Revenue Code *"}),e.jsx("input",{type:"text",value:l.revenue_code,onChange:s=>a("revenue_code",s.target.value),placeholder:"e.g., FNG7244210",required:!0}),t.revenue_code&&e.jsx("span",{className:"error-msg",children:t.revenue_code})]}),e.jsxs("div",{className:"input-group",children:[e.jsx("label",{children:"Cycle *"}),e.jsxs("select",{value:l.cycle,onChange:s=>a("cycle",s.target.value),children:[e.jsx("option",{value:"termly",children:"Termly"}),e.jsx("option",{value:"annually",children:"Annually"})]})]}),e.jsxs("div",{className:"input-group",children:[e.jsx("label",{children:"Type *"}),e.jsxs("select",{value:l.type,onChange:s=>a("type",s.target.value),children:[e.jsx("option",{value:"compulsory",children:"Compulsory"}),e.jsx("option",{value:"optional",children:"Optional"})]})]}),e.jsxs("div",{className:"input-group",children:[e.jsx("label",{children:"Payee Allowed *"}),e.jsxs("select",{value:l.payee_allowed,onChange:s=>a("payee_allowed",s.target.value),children:[e.jsx("option",{value:"students",children:"Students"}),e.jsx("option",{value:"all",children:"All"})]})]}),e.jsxs("div",{className:"input-group",children:[e.jsx("label",{children:"Amount (₦) *"}),e.jsx("input",{type:"number",value:l.amount,onChange:s=>a("amount",s.target.value),placeholder:"0",required:!0}),t.amount&&e.jsx("span",{className:"error-msg",children:t.amount})]}),e.jsxs("div",{className:"input-group",children:[e.jsx("label",{children:"Charge Bearer *"}),e.jsxs("select",{value:l.charge_bearer,onChange:s=>a("charge_bearer",s.target.value),children:[e.jsx("option",{value:"self",children:"Self"}),e.jsx("option",{value:"institution",children:"Institution"})]})]}),e.jsxs("div",{className:"input-group",children:[e.jsx("label",{children:"Status *"}),e.jsxs("select",{value:l.status,onChange:s=>a("status",s.target.value),children:[e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"inactive",children:"Inactive"})]})]})]}),e.jsxs("div",{className:"modal-footer-actions",children:[e.jsx("button",{type:"button",className:"secondary-btn",onClick:()=>n(!1),children:"Cancel"}),e.jsx("button",{type:"submit",className:"primary-btn",disabled:p,children:p?"Processing...":r==="add"?"Add Fee":"Save Changes"})]})]})]})}),y&&d&&e.jsx(T,{fee:d,onClose:()=>N(!1),bankAccounts:x})]})]})};export{H as default};

import{u as v,j as e}from"./app-Dxo-ct31.js";import{C as _}from"./circle-alert-Cshd0O87.js";import{T as w}from"./trash-2-CQuqhMWS.js";import{P as k}from"./plus-WbP0mYxu.js";import{S}from"./save-BS-fcSwn.js";const N=({fee:i,onClose:d,bankAccounts:c=[]})=>{const u=i.beneficiaries&&i.beneficiaries.length>0?i.beneficiaries.map(t=>({...t,amount:Math.round(parseFloat(t.percentage)/100*i.raw_amount)})):[{account_name:"",account_number:"",bank_name:"",amount:""}],{data:a,setData:l,post:x,processing:m,errors:B}=v({beneficiaries:u}),g=()=>{l("beneficiaries",[...a.beneficiaries,{account_name:"",account_number:"",bank_name:"",amount:""}])},b=t=>{const r=[...a.beneficiaries];r.splice(t,1),l("beneficiaries",r)},f=(t,r,n)=>{const o=[...a.beneficiaries];{const j=parseFloat(n)||0;o[t].amount=n,o[t].percentage=i.raw_amount>0?(j/i.raw_amount*100).toFixed(2):0}l("beneficiaries",o)},h=(t,r)=>{const n=c.find(o=>o.id==r);if(n){const o=[...a.beneficiaries];o[t]={...o[t],bank_account_id:n.id,account_name:n.account_name,account_number:n.account_number,bank_name:n.bank_name},l("beneficiaries",o)}},p=a.beneficiaries.reduce((t,r)=>t+(parseFloat(r.amount)||0),0),s=Math.abs(p-i.raw_amount)<1,y=t=>{if(t.preventDefault(),!s){alert(`Total amount must equal ₦${i.raw_amount.toLocaleString()}`);return}x(`/fees/${i.id}/beneficiaries`,{onSuccess:()=>{d()}})};return e.jsx("div",{className:"modal-overlay",onClick:d,style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},children:e.jsxs("div",{className:"modal-content",onClick:t=>t.stopPropagation(),style:{background:"white",borderRadius:"12px",width:"90%",maxWidth:"800px",maxHeight:"90vh",overflowY:"auto",boxShadow:"0 10px 25px rgba(0,0,0,0.1)"},children:[e.jsxs("div",{className:"modal-header",style:{padding:"20px 24px",borderBottom:"1px solid #eee",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("div",{children:[e.jsx("h3",{style:{margin:0,fontSize:"1.25rem",color:"#1a1a1a"},children:"Split Beneficiaries"}),e.jsxs("p",{style:{margin:"4px 0 0",color:"#666",fontSize:"0.9rem"},children:["Total Fee Amount: ",e.jsxs("strong",{children:["₦",i.raw_amount.toLocaleString()]})]})]}),e.jsx("button",{onClick:d,style:{background:"none",border:"none",fontSize:"24px",cursor:"pointer",color:"#999"},children:"×"})]}),e.jsxs("form",{onSubmit:y,style:{padding:"24px"},children:[!s&&e.jsxs("div",{style:{display:"flex",gap:"10px",padding:"12px",background:"#ffebee",borderRadius:"8px",color:"#c62828",marginBottom:"20px",fontSize:"0.9rem"},children:[e.jsx(_,{size:20}),e.jsxs("div",{children:[e.jsx("strong",{children:"Invalid Total Allocation"}),e.jsxs("p",{style:{margin:0},children:["Total split must equal ₦",i.raw_amount.toLocaleString(),". Current: ₦",p.toLocaleString()," (Diff: ₦",(i.raw_amount-p).toLocaleString(),")"]})]})]}),e.jsxs("div",{className:"beneficiaries-list",children:[e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr 120px 40px",gap:"12px",paddingBottom:"8px",borderBottom:"1px solid #eee",marginBottom:"12px",fontWeight:"600",fontSize:"0.85rem",color:"#666"},children:[e.jsx("div",{children:"Account Name"}),e.jsx("div",{children:"Account Number"}),e.jsx("div",{children:"Bank Name"}),e.jsx("div",{children:"Amount (₦)"}),e.jsx("div",{})]}),a.beneficiaries.map((t,r)=>e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr 120px 40px",gap:"12px",marginBottom:"12px",alignItems:"start"},children:[e.jsxs("div",{style:{gridColumn:"1 / span 3",display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:"12px"},children:[c.length>0?e.jsxs("select",{onChange:n=>h(r,n.target.value),style:{width:"100%",padding:"10px",borderRadius:"6px",border:"1px solid #ddd",gridColumn:"span 3",marginBottom:"8px"},value:t.bank_account_id||"",children:[e.jsx("option",{value:"",children:"-- Select Bank Account --"}),c.map(n=>e.jsxs("option",{value:n.id,children:[n.bank_name," - ",n.account_name," (",n.account_number,")"]},n.id))]}):null,e.jsx("input",{type:"text",value:t.account_name,readOnly:!0,placeholder:"Account Name",style:{width:"100%",padding:"10px",borderRadius:"6px",border:"1px solid #eee",background:"#f9f9f9",color:"#666"}}),e.jsx("input",{type:"text",value:t.account_number,readOnly:!0,placeholder:"Account Number",style:{width:"100%",padding:"10px",borderRadius:"6px",border:"1px solid #eee",background:"#f9f9f9",color:"#666"}}),e.jsx("input",{type:"text",value:t.bank_name,readOnly:!0,placeholder:"Bank Name",style:{width:"100%",padding:"10px",borderRadius:"6px",border:"1px solid #eee",background:"#f9f9f9",color:"#666"}})]}),e.jsxs("div",{style:{position:"relative"},children:[e.jsx("input",{type:"number",value:t.amount,onChange:n=>f(r,"amount",n.target.value),placeholder:"0",required:!0,min:"0",max:i.raw_amount,style:{width:"100%",padding:"10px",borderRadius:"6px",border:"1px solid #ddd"}}),e.jsx("span",{style:{position:"absolute",right:"0",top:"42px",color:"#999",fontSize:"0.75rem",width:"100%",textAlign:"right"},children:t.percentage?`${parseFloat(t.percentage).toFixed(1)}%`:"0%"})]}),e.jsx("button",{type:"button",onClick:()=>b(r),style:{height:"40px",color:"#d32f2f",background:"#ffebee",border:"none",borderRadius:"6px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(w,{size:18})})]},r))]}),e.jsxs("button",{type:"button",className:"add-row-btn",onClick:g,style:{marginTop:"20px",color:"#E91E63",fontWeight:"500",background:"transparent",border:"1px dashed #E91E63",padding:"10px",width:"100%",borderRadius:"6px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px"},children:[e.jsx(k,{size:18})," Add Another Account"]}),e.jsxs("div",{style:{marginTop:"24px",paddingTop:"20px",borderTop:"1px solid #eee",display:"flex",justifyContent:"flex-end",gap:"12px"},children:[e.jsx("button",{type:"button",onClick:d,style:{padding:"10px 20px",borderRadius:"6px",border:"1px solid #ddd",background:"white",color:"#666",cursor:"pointer",fontWeight:"500"},children:"Cancel"}),e.jsxs("button",{type:"submit",disabled:m||!s,style:{padding:"10px 24px",borderRadius:"6px",border:"none",background:s?"#E91E63":"#ccc",color:"white",cursor:s?"pointer":"not-allowed",fontWeight:"500",display:"flex",alignItems:"center",gap:"8px"},children:[e.jsx(S,{size:18})," Save Splits"]})]})]})]})})};export{N as F};

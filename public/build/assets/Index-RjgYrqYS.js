import{r as c,j as e,H as f,a as h}from"./app-Biat6RVR.js";import{X as w,L as C}from"./Layout-DIydNzPb.js";import{c as g}from"./createLucideIcon-Cjv62a5S.js";import{E as T}from"./ellipsis-vertical-DYqoF817.js";import{C as p}from"./circle-check-big-BRm-L6Vi.js";const Y=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],D=g("arrow-right",Y);const A=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],E=g("circle-check",A),_=({isOpen:o,onClose:t,currentTerm:a,onNext:m})=>{if(!o)return null;const[n,r]=c.useState("keep");return e.jsx("div",{className:"term-modal-overlay",onClick:t,children:e.jsxs("div",{className:"term-modal-content",onClick:i=>i.stopPropagation(),children:[e.jsx("div",{className:"term-modal-header",children:e.jsx("h3",{children:"Start Next Term"})}),e.jsxs("div",{className:"term-modal-body",children:[e.jsxs("div",{className:"term-info-row",children:[e.jsx("div",{className:"term-check-icon",children:e.jsx(E,{size:20,color:"#10B981"})}),e.jsx("p",{className:"term-info-text",children:"Starting a new term advances the academic session accordingly."})]}),e.jsxs("p",{className:"term-question",children:["How do you want to handle outstanding payments in the current term ( ",a||"1st Term"," )"]}),e.jsxs("div",{className:"term-radio-group",children:[e.jsxs("label",{className:"term-radio-label",children:[e.jsx("input",{type:"radio",name:"paymentAction",value:"waive",checked:n==="waive",onChange:()=>r("waive")}),e.jsx("span",{className:"radio-text",children:"Waive All Outstanding Payments"})]}),e.jsxs("label",{className:"term-radio-label",children:[e.jsx("input",{type:"radio",name:"paymentAction",value:"keep",checked:n==="keep",onChange:()=>r("keep")}),e.jsx("span",{className:"radio-text",children:"Keep All Outstanding Payments"})]})]})]}),e.jsxs("div",{className:"term-modal-footer",children:[e.jsx("button",{className:"term-next-btn",onClick:()=>m(n),children:"Next"}),e.jsx("button",{className:"term-close-btn",onClick:t,children:"Close"})]})]})})},z=({isOpen:o,onClose:t,onSave:a})=>{if(!o)return null;const[m,n]=c.useState("2026/2027"),[r,i]=c.useState(""),[x,j]=c.useState(""),N=()=>{a(m,r,x)};return e.jsx("div",{className:"new-session-modal-overlay",onClick:t,children:e.jsxs("div",{className:"new-session-modal-content",onClick:l=>l.stopPropagation(),children:[e.jsx("div",{className:"new-session-modal-close",children:e.jsxs("button",{className:"close-btn-circle",onClick:t,children:[e.jsx(w,{size:20,color:"#EF4444"})," "]})}),e.jsxs("div",{className:"new-session-modal-body",children:[e.jsx("h2",{className:"modal-title",children:"Next Session"}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"input-label",children:"Session Year"}),e.jsx("input",{type:"text",className:"session-input",value:m,onChange:l=>n(l.target.value),placeholder:"YYYY/YYYY"})]}),e.jsxs("div",{className:"form-group-row",style:{display:"flex",gap:"16px",marginTop:"16px"},children:[e.jsxs("div",{className:"form-group",style:{flex:1},children:[e.jsx("label",{className:"input-label",style:{display:"block",marginBottom:"8px",fontSize:"0.9rem",fontWeight:600,color:"#475569"},children:"Start Date"}),e.jsx("input",{type:"date",className:"session-input",value:r,onChange:l=>i(l.target.value)})]}),e.jsxs("div",{className:"form-group",style:{flex:1},children:[e.jsx("label",{className:"input-label",style:{display:"block",marginBottom:"8px",fontSize:"0.9rem",fontWeight:600,color:"#475569"},children:"End Date"}),e.jsx("input",{type:"date",className:"session-input",value:x,onChange:l=>j(l.target.value)})]})]}),e.jsx("button",{className:"save-session-btn",onClick:N,style:{marginTop:"24px"},children:"Save"})]})]})})},B=({sessions:o=[]})=>{const[t,a]=c.useState(null),[m,n]=c.useState(!1),[r,i]=c.useState(!1),[x,j]=c.useState(null);c.useEffect(()=>{const s=d=>{t&&!d.target.closest(".action-cell")&&a(null)};return document.addEventListener("mousedown",s),()=>document.removeEventListener("mousedown",s)},[t]);const N=s=>{a(t===s?null:s)},l=s=>{j(s),a(null),n(!0)},y=s=>{h.put(`/academic-sessions/${s.id}/toggle-status`,{},{onSuccess:()=>a(null)})},v=(s,d)=>{h.post(`/academic-sessions/${s.id}/set-term`,{term:d},{onSuccess:()=>a(null)})},b=s=>{h.post(`/academic-sessions/${x.id}/next-term`,{payment_action:s},{onSuccess:()=>n(!1)})},k=(s,d,u)=>{h.post("/academic-sessions",{year:s,start_date:d,end_date:u},{onSuccess:()=>i(!1)})};return e.jsxs(C,{children:[e.jsx(f,{title:"Academic Sessions"}),e.jsxs("div",{className:"sessions-page",children:[e.jsxs("div",{className:"page-header",children:[e.jsx("h1",{className:"page-title",children:"Sessions"}),e.jsx("button",{className:"new-session-btn",onClick:()=>i(!0),children:"+ New Session"})]}),e.jsx("div",{className:"sessions-table-container card",children:e.jsxs("table",{className:"sessions-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"S/N"}),e.jsx("th",{children:"Year"}),e.jsx("th",{children:"Active Term"}),e.jsx("th",{children:"Start Date"}),e.jsx("th",{children:"End Date"}),e.jsx("th",{children:"Status"}),e.jsx("th",{})]})}),e.jsxs("tbody",{children:[o.map((s,d)=>e.jsxs("tr",{children:[e.jsx("td",{children:d+1}),e.jsx("td",{children:s.year}),e.jsx("td",{children:e.jsx("div",{className:"term-display",children:e.jsx("span",{className:"current-term-tag",children:s.term})})}),e.jsx("td",{className:"text-sm text-gray-600",children:s.start_date||"-"}),e.jsx("td",{className:"text-sm text-gray-600",children:s.end_date||"-"}),e.jsx("td",{children:e.jsxs("span",{className:`status-badge ${s.status}`,children:[e.jsx("span",{className:"status-dot"}),s.status.charAt(0).toUpperCase()+s.status.slice(1)]})}),e.jsxs("td",{className:"action-cell",style:{position:"relative"},children:[e.jsx("button",{className:"action-btn",onClick:()=>N(s.id),children:e.jsx(T,{size:18})}),t===s.id&&e.jsxs("div",{className:"action-dropdown shadow-lg",children:[e.jsx("div",{className:"dropdown-section-label",children:"Switch Term"}),e.jsxs("button",{className:`dropdown-item ${s.term==="1st Term"?"selected":""}`,onClick:()=>v(s,"1st Term"),children:[e.jsx(p,{size:14,className:s.term==="1st Term"?"visible":"hidden"}),e.jsx("span",{children:"1st Term"})]}),e.jsxs("button",{className:`dropdown-item ${s.term==="2nd Term"?"selected":""}`,onClick:()=>v(s,"2nd Term"),children:[e.jsx(p,{size:14,className:s.term==="2nd Term"?"visible":"hidden"}),e.jsx("span",{children:"2nd Term"})]}),e.jsxs("button",{className:`dropdown-item ${s.term==="3rd Term"?"selected":""}`,onClick:()=>v(s,"3rd Term"),children:[e.jsx(p,{size:14,className:s.term==="3rd Term"?"visible":"hidden"}),e.jsx("span",{children:"3rd Term"})]}),e.jsx("div",{className:"dropdown-divider"}),e.jsxs("button",{className:"dropdown-item",onClick:()=>l(s),children:[e.jsx(D,{size:14}),e.jsx("span",{children:"Start Next Term"})]}),e.jsxs("button",{className:"dropdown-item",onClick:()=>{const u=prompt("Enter Start Date (YYYY-MM-DD)",s.start_date||"");if(u){const S=prompt("Enter End Date (YYYY-MM-DD)",s.end_date||"");S&&h.put(`/academic-sessions/${s.id}`,{start_date:u,end_date:S})}a(null)},children:[e.jsx(p,{size:14}),e.jsx("span",{children:"Update Dates"})]}),s.status==="inactive"&&e.jsxs("button",{className:"dropdown-item active-action",onClick:()=>y(s),children:[e.jsx(p,{size:14,color:"#10b981"}),e.jsx("span",{children:"Make Session Active"})]})]})]})]},s.id)),o.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:"7",className:"empty-state",children:"No sessions found."})})]})]})}),e.jsx(_,{isOpen:m,onClose:()=>n(!1),currentTerm:x?.term,onNext:b}),e.jsx(z,{isOpen:r,onClose:()=>i(!1),onSave:k})]})]})};export{B as default};
